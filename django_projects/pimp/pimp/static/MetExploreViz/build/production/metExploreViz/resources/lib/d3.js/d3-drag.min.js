!function(b,a){"object"==typeof exports&&"undefined"!=typeof module?a(exports,require("d3-dispatch"),require("d3-selection")):"function"==typeof define&&define.amd?define(["exports","d3-dispatch","d3-selection"],a):a(b.d3=b.d3||{},b.d3,b.d3)}(this,function(p,y,h){function g(){h.event.stopImmediatePropagation()}function k(){h.event.preventDefault(),h.event.stopImmediatePropagation()}function b(c){var a=c.document.documentElement,d=h.select(c).on("dragstart.drag",k,!0);"onselectstart" in a?d.on("selectstart.drag",k,!0):(a.__noselect=a.style.MozUserSelect,a.style.MozUserSelect="none")}function x(d,a){var f=d.document.documentElement,c=h.select(d).on("dragstart.drag",null);a&&(c.on("click.drag",k,!0),setTimeout(function(){c.on("click.drag",null)},0)),"onselectstart" in f?c.on("selectstart.drag",null):(f.style.MozUserSelect=f.__noselect,delete f.__noselect)}function v(a){return function(){return a}}function z(B,F,l,f,A,d,E,C,G,D){this.target=B,this.type=F,this.subject=l,this.identifier=f,this.active=A,this.x=d,this.y=E,this.dx=C,this.dy=G,this._=D}function w(){return !h.event.button}function q(){return this.parentNode}function j(a){return null==a?{x:h.event.x,y:h.event.y}:a}function m(){function s(f){f.on("mousedown.drag",r).on("touchstart.drag",o).on("touchmove.drag",D).on("touchend.drag touchcancel.drag",c).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function r(){if(!C&&B.apply(this,arguments)){var f=u("mouse",A.apply(this,arguments),h.mouse,this,arguments);f&&(h.select(h.event.view).on("mousemove.drag",n,!0).on("mouseup.drag",a,!0),b(h.event.view),g(),t=!1,f("start"))}}function n(){k(),t=!0,l.mouse("drag")}function a(){h.select(h.event.view).on("mousemove.drag mouseup.drag",null),x(h.event.view,t),k(),l.mouse("end")}function o(){if(B.apply(this,arguments)){var I,G,E=h.event.changedTouches,H=A.apply(this,arguments),f=E.length;for(I=0;I<f;++I){(G=u(E[I].identifier,H,h.touch,this,arguments))&&(g(),G("start"))}}}function D(){var G,f,H=h.event.changedTouches,E=H.length;for(G=0;G<E;++G){(f=l[H[G].identifier])&&(k(),f("drag"))}}function c(){var H,E,f=h.event.changedTouches,G=f.length;for(C&&clearTimeout(C),C=setTimeout(function(){C=null},500),H=0;H<G;++H){(E=l[f[H].identifier])&&(g(),E("end"))}}function u(O,E,H,e,N){var L,M,K,G=H(E,O),J=F.copy();if(h.customEvent(new z(s,"beforestart",L,O,d,G[0],G[1],0,0,J),function(){return null!=(h.event.subject=L=i.apply(e,N))&&(M=L.x-G[0]||0,K=L.y-G[1]||0,!0)})){return function I(Q){var P,f=G;switch(Q){case"start":l[O]=I,P=d++;break;case"end":delete l[O],--d;case"drag":G=H(E,O),P=d}h.customEvent(new z(s,Q,L,O,P,G[0]+M,G[1]+K,G[0]-f[0],G[1]-f[1],J),J.apply,J,[Q,e,N])}}}var t,C,B=w,A=q,i=j,l={},F=y.dispatch("start","drag","end"),d=0;return s.filter=function(e){return arguments.length?(B="function"==typeof e?e:v(!!e),s):B},s.container=function(e){return arguments.length?(A="function"==typeof e?e:v(e),s):A},s.subject=function(e){return arguments.length?(i="function"==typeof e?e:v(e),s):i},s.on=function(){var e=F.on.apply(F,arguments);return e===F?s:e},s}z.prototype.on=function(){var a=this._.on.apply(this._,arguments);return a===this._?this:a},p.drag=m,p.dragDisable=b,p.dragEnable=x,Object.defineProperty(p,"__esModule",{value:!0})});